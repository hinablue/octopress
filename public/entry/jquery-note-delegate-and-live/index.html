
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>[jQuery note.] jQuery 1.5 在 Events 的探勘 - HINA::工程幼稚園</title>
  <meta name="author" content="hinablue">

  
  <meta name="description" content="UPDATE, 還是認真說明一下好了（笑） 委派事件（delegate）跟 live 事件其實是指同一件事情，不過有幾個地方不同： 由於 live 事件直接綁定在 document 上，所以一旦有中途有事件傳播被取消（stopPropagation），該 live 事件就不會被觸發。委派事件（ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.hinablue.me/entry/jquery-note-delegate-and-live">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/hinablue" rel="alternate" title="HINA::工程幼稚園" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-259895-17']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">HINA::工程幼稚園</a></h1>
  
    <h2>偏執與強迫症的患者，算不上是無可救藥，只是我已經遇上我的良醫了。</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/hinablue" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.hinablue.me" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">[jQuery Note.] jQuery 1.5 在 Events 的探勘</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-11T14:21:00+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><strong><font color="#FF0000">UPDATE, 還是認真說明一下好了（笑）</font></strong></p>

<p>委派事件（delegate）跟 live 事件其實是指同一件事情，不過有幾個地方不同：</p>

<ol><li>由於 live 事件直接綁定在 document 上，所以一旦有中途有事件傳播被取消（stopPropagation），該 live 事件就不會被觸發。</li><li>委派事件（delegate）同樣使用 live 事件的綁定方式，不同的是，他的事件傳播會依序傳回直到被中斷為止。</li></ol>


<p>請看以下範例：</p>

<ol><li><a href="http://jsfiddle.net/hinablue/KFkGZ/1/">http://jsfiddle.net/hinablue/KFkGZ/1/</a> 完全不中斷事件傳播。</li><li><a href="http://jsfiddle.net/hinablue/KFkGZ/2/">http://jsfiddle.net/hinablue/KFkGZ/2/</a> 從 workspace 的 DIV 中斷事件傳播。</li><li><a href="http://jsfiddle.net/hinablue/KFkGZ/3/">http://jsfiddle.net/hinablue/KFkGZ/3/</a> 從 body 的 DOM 中斷事件傳播。</li><li><a href="http://jsfiddle.net/hinablue/KFkGZ/4/">http://jsfiddle.net/hinablue/KFkGZ/4/</a> 從 live 本身中斷事件傳播。</li></ol>


<p>差異性在：</p>

<ol><li>完全不中斷，所有事件都執行完畢。</li><li>從父元件（DIV#workspace）中斷，使用委派事件的子元件依舊會執行，<strong><font color="#FF0000">使用 live 則被中斷。</font></strong></li><li>從 body（DOM#Element）中斷，二者接執行到 body 事件後中斷，<strong><font color="#FF0000">live 依舊不執行。</font></strong></li><li>從 live 本身中斷，<strong><font color="#FF0000">無效！並無法中斷該事件傳播！</font></strong></li></ol>


<p>這就是委派事件與 live 事件的差異性。在使用 live 的時候，得注意事件傳播是否有被中斷，否則一旦使用了 stopPropagation()，則有可能會讓 .live 事件消失。</p>

<p><strong><font color="#008000">[以下是舊文]</font></strong>
首先我要說的是，在 jQuery 1.5 有改寫 Events 的部份，所以測試的環節不能拿 1.4+ 的來用，會出錯。至於為什麼會這樣？這不要問我，還是去問官方會比較實際。反正，改都改了，除非你有拿 jQuery 的核心來做一些<a href="http://blog.hinablue.me/869" target="_blank">齷齪的事情</a>，不然應該不會有影響才是。像是我之前寫的筆記，就只能用在 1.4+ 以前的版本，拿到 1.5 來用可能就會出問題了。</p>

<!-- more -->


<p>首先是，Events 綁定之後，在 $.cache 中會多一層物件（Object），命名方式是以 jQuery 尾數加上一串亂數而成。跟 1.4+ 相比，要取得 $.cache 的內容就變得相對複雜許多。當然，要取得 jQuery 的亂數，還是有一些暗黑技法可以用，反正多看幾次原始碼，要找到寶藏其實也沒那麼困難。</p>

<pre><code>var jqExpando = jQuery.expando; // jqExpando 應該是 jQuery15028725506574846804 這種樣子。
</code></pre>

<p>然後來簡單筆記 delegate 跟 live 的差異性。其實，端看原始碼，這兩種東西幾乎是一樣的，你在原始碼中也會發現，其實呼叫 delegate，他會去呼叫 live 來用。那我就直接用 live 就好啦！事實上，事情當然不像我這種阿呆想得那麼簡單！根據官方的說法是：</p>

<blockquote>Attach a handler to one or more events for all elements that match the selector, now or in the future, based on a specific set of root elements.</blockquote>


<p>由於我英文不好，所以我就一言以蔽之：有老爸罩比較好辦事（喂喂喂）！</p>

<p>另外一點，官方有特別提起在 live 與 delegate 之中，關於 event.stopPropagation() 的不同。根據官方的說法是：</p>

<blockquote>Since the .live() method handles events once they have propagated to the top of the document, it is not possible to stop propagation of live events. Similarly, events handled by .delegate() will always propagate to the element to which they are delegated; event handlers on any elements below it will already have been executed by the time the delegated event handler is called.</blockquote>


<p>由於我英文太爛，所以簡單來說是：叫傳播不要用自己的手機（疑）！</p>

<p>舉個簡單的例子來看：</p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;style&gt;
            h3 { color:red; }
            span { color:green; }
        &lt;/style&gt; 
        &lt;script src="http://code.jquery.com/jquery-1.5.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="workspace"&gt;
            &lt;h3 class="live-event"&gt;Click me, by .live&lt;/h3&gt;
            &lt;h3 class="delegate-event"&gt;Click me, by .delegate&lt;/h3&gt;
        &lt;/div&gt;
        &lt;script&gt;
            $("#workspace").click(function(e) {
                e.stopPropagation();
                $(this).append("There is #workspace click event.&lt;br /&gt;");
            }, false);
            $(".live-event").live("click", function(e){
                $(this).parent().append("&lt;span&gt;There is .live click event.&lt;/span&gt;&lt;br /&gt;");
            }, false);
            $("#workspace").delegate(".delegate-event", "click", function(e) {
                $(this).parent().append("&lt;span&gt;There is .delegate click event.&lt;/span&gt;&lt;br /&gt;");
            }, false);
        &lt;/script&gt;
    &lt;/body&gt;
</code></pre>

<p>另外，由於 .delegate 有老爸罩（？）的關係，所以在事件綁定上，速度與記憶體的使用量，要比直接使用 .live 要來的快，記憶體也用的比較少。所以，扣掉事件傳播這個可能需要考量的地方之外，如果要大量的綁定事件的話，建議使用 .delegate 會比 .live 要來得好得多。畢竟他跟 .live 效果是完全一樣的（扣掉事件傳播這件事情）。</p>

<p>至於，什麼時候該用 .live？這，請拿出兩個十元，然後平心境氣得往前扔，如果出現一正一反，那應該就可以用！如果發現兩顆硬幣站起來了，不要慌張，趕快看一下有什麼號碼，然後打電話給我！</p>

<p>我的電話在螢幕下方，請自便。</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">hinablue</span></span>

      








  


<time datetime="2011-02-11T14:21:00+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/categories/jquery/'>jQuery</a>, <a class='category' href='/categories/javascript/'>javascript</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://blog.hinablue.me/entry/jquery-note-delegate-and-live/" data-via="hinablue" data-counturl="http://blog.hinablue.me/entry/jquery-note-delegate-and-live/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/entry/photos-thai-food-in-Gueng-Guan/" title="Previous Post: [影像] 這不是宵夜之泰國小館">&laquo; [影像] 這不是宵夜之泰國小館</a>
      
      
        <a class="basic-alignment right" href="/entry/photos-second-floor-cafe-2011-02-13/" title="next Post: [影像] 又是公館貳樓">[影像] 又是公館貳樓 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <img src="/images/hniablue_icon.jpg" width="195" height="195" alt="Hina, Cain Chen." />
  <p>我是閃光洽！</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
  </ul>
</section>
<script type="text/javascript">
    $.domReady(function() {
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }
        (function() {
            $.ajax({
                url: '/atom.xml',
                dataType: 'xml',
                success: function(xml) {
                    var parser, expectedXML;
                    if (window.DOMParser) {
                        parser = new DOMParser();
                        expectedXML = parser.parseFromString(decodeURIComponent(xml.response),"text/xml");
                    } else {
                        expectedXML = new ActiveXObject("Microsoft.XMLDOM");
                        expectedXML.async = false;
                        expectedXML.loadXML(decodeURIComponent(xml.response));
                    }

                    var entries = expectedXML.getElementsByTagName('entry');
                    var entries_limit = entries.length > 5 ? 5 : entries.length;
                    for(var i=0; i<entries_limit; i++) {
                        $('<a/>')
                        .attr('href', entries[i].childNodes[3].attributes[0].nodeValue)
                        .text(entries[i].childNodes[1].childNodes[0].nodeValue)
                        .appendTo($('<li/>').addClass('post').appendTo($('#recent_posts')));
                    }
                },
                error: function(err) {
                    $('<li/>').addClass('post').text('Error Loading feed').appendTo($('#recent_posts'));
                }
            });
        })();
    });
</script>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/hinablue">@hinablue</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'hinablue',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("hinablue", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/hinablue" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @hinablue</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/104812280860478253996?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2011 - hinablue -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'hinablue';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.hinablue.me/entry/jquery-note-delegate-and-live/';
        var disqus_url = 'http://blog.hinablue.me/entry/jquery-note-delegate-and-live/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
